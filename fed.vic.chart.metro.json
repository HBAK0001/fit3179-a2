{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "width": 500,
  "height": 300,
  "data": {
    "url": "https://hbak0001.github.io/fit3179-a2/data/fed-cand-2-2019.csv"
  },
  "mark": "geoshape",
  "encoding": {
    "color": {
      "field": "PartyNm",
      "type": "nominal",
      "scale": {
        "range": [
          "red",
          "blue",
          "lightgreen"
        ]
      }
    }
  },
  "autosize": "fit-x",
  "transform": [
    {
      "lookup": "DivisionNm",
      "from": {
        "key": "properties.Sortname",
        "data": {
          "url": "https://hbak0001.github.io/fit3179-a2/geoJSON/fed/fed-vic-2018.geojson",
          "format": {"property": "features"}
        },
        "fields": ["geometry", "properties", "type"]
      }
    },
    {
      "joinaggregate": [
        {
          "op": "max",
          "field": "TotalVotes",
          "as": "maxVotes"
        }],
      "groupby": ["DivisionNm"]
    },
    {
      "filter": "datum.TotalVotes == datum.maxVotes"
    },
    {
      "filter": {
        "field": "properties.Sortname",
        "oneOf": [
          "Melbourne", "Gellibrand", "Goldstein", "Isaacs",
          "Macnamara", "Dunkley", "Holt", "Bruce", "Hotham",
          "Wills", "Higgins", "Chisholm", "Aston", "Deakin",
          "Jagajaga", "Menzies", "Kooyong", "Cooper", "Scullin",
          "Calwell", "Maribyrnong", "Fraser", "Lalor", "Gorton"
        ]
      }
    },
    {
      "filter": {
        "field": "StateAb",
        "equal": "VIC"
      }
    }
  ]
}