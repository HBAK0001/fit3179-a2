{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "width": 500,
  "height": 300,
  "data": {
    "url": "https://hbak0001.github.io/fit3179-a2/data/fed-cand-2-2019.csv"
  },
  "mark": "geoshape",
  "encoding": {
    "color": {
      "field": "PartyNm",
      "type": "nominal",
      "scale": {
        "range": [
          "#E65015",
          "gray",
          "#2A7CFF",
          "#1CB33A"
        ]
      }
    }
  },
  "autosize": "fit-x",
  "transform": [
    {
      "lookup": "DivisionNm",
      "from": {
        "key": "properties.Sortname",
        "data": {
          "url": "https://hbak0001.github.io/fit3179-a2/geoJSON/fed/fed-vic-2018.geojson",
          "format": {"property": "features"}
        },
        "fields": ["geometry", "properties", "type"]
      }
    },
    {
      "joinaggregate": [
        {
          "op": "max",
          "field": "TotalVotes",
          "as": "maxVotes"
        }],
      "groupby": ["DivisionNm"]
    },
    {
      "filter": "datum.TotalVotes == datum.maxVotes"
    },
    {
      "filter": {
        "field": "properties.Sortname",
        "oneOf": [
          "Mallee", "Wannon",  "Nicholls", "Bendigo",
          "McEwen", "Ballarat", "Corangamite",
          "Indi", "Gippsland", "Monash", "Casey", 
          "La Trobe", "Corio"
        ]
      }
    },
    {
      "filter": {
        "field": "StateAb",
        "equal": "VIC"
      }
    }
  ]
}